package  {		import flash.display.*;	import flash.display.Sprite;	import flash.display.DisplayObject;	import flash.text.TextField;		import flash.net.*;		import flash.events.Event;	import flash.events.MouseEvent;	import flash.events.IEventDispatcher;	import flash.events.DataEvent;	import flash.events.IOErrorEvent;	import flash.events.SecurityErrorEvent;	import flash.events.HTTPStatusEvent;	import flash.events.ProgressEvent;	import flash.display.Loader;	import flash.external.ExternalInterface;		import com.websitemediaplayers.utils.Globals;		public class Silueta extends MovieClip {				var fullScreen:Boolean = false;		var carga_completa:Boolean = false;		public function Silueta() {			// constructor code			//ExternalInterface.call("terminaUploadAll",timestamp,extension,"http://cushman.pro/uploaded/");			trace("Silueta");			Globals.vars.home=this;			salida_txt.text="";			full_mc.addEventListener(MouseEvent.CLICK, toggleScreen);						stage.align = StageAlign.TOP_LEFT;			stage.scaleMode = StageScaleMode.NO_SCALE;						this.addEventListener(MouseEvent.CLICK,AgregarPunto);			this.addEventListener(Event.ENTER_FRAME,ElEnterFrame);			clean_mc.addEventListener(MouseEvent.CLICK,Clean);			previo_mc.addEventListener(MouseEvent.CLICK,Previsualizar);						previo_mc.alpha=0.5;						puntos_array=new Array();		}						function Previsualizar(e:Event){			if(carga_completa==true && puntos_array.length>2){				Globals.vars.peviosilueta.CargaSilueta(last_foto_url,puntos_array);			}		}						function ElEnterFrame(e:Event) {			if(puntos_array.length>2){				silueta_mc.graphics.clear();				silueta_mc.graphics.lineStyle(1, 0x999999, 0.8);				silueta_mc.graphics.beginFill(0x666666, 0.5);				var str_cont:String=puntos_array[0];				for(var i=0;i<puntos_array.length;i++){					str_cont=puntos_array[i];					var t_arr=str_cont.split(",");					if(i==0){						silueta_mc.graphics.moveTo(t_arr[0],t_arr[1]);					}else{						silueta_mc.graphics.lineTo(t_arr[0],t_arr[1]);					}				}			}		}				function Clean(e:Event) {			removeChildrenOf(silueta_mc);			puntos_array=new Array();			silueta_mc.graphics.clear();			puntos_txt.text="0 puntos";			previo_mc.alpha=0.5;			Globals.vars.peviosilueta.Clean();		}				var puntos_array;				function AgregarPunto(e:Event) {			if(carga_completa==true && this.mouseY>150){				var p_mc = new Punto();				p_mc.x=this.mouseX;				p_mc.y=this.mouseY;				silueta_mc.addChild(p_mc);				puntos_array[puntos_array.length] = p_mc.x+","+p_mc.y;				//trace(puntos_array.length+"  "+PuntosAGuardar(puntos_array));				ExternalInterface.call("terminaSilueta",PuntosAGuardar(puntos_array));				puntos_txt.text = puntos_array.length+" puntos";				if(puntos_array.length>2){					previo_mc.alpha=1;				}			}		}				function PuntosAGuardar (p_array) {			var t_str:String="";			for (var i=0;i<p_array.length;i++) {				t_str+=p_array[i]+";";			}			t_str=t_str.substr(0,t_str.length-1);			return (t_str);		}				function removeChildrenOf(mc:MovieClip):void{			if(mc.numChildren!=0){				var k:int = mc.numChildren;				while( k -- )				{					mc.removeChildAt( k );				}			}		}				function toggleScreen(e:MouseEvent):void		{		   if(fullScreen == false)		   {				fullScreen = true;				stage.displayState = StageDisplayState.FULL_SCREEN;				full_mc.gotoAndStop(2);		   }		   else		   {				fullScreen = false;				stage.displayState = StageDisplayState.NORMAL; 				full_mc.gotoAndStop(1);		   }				}						public function CargarImagen( t_fun,  t_time,  t_ext,  t_server) {			//"terminaUploadAll",timestamp,extension,"http://cushman.pro/uploaded/"			var t_imagen=t_server+t_time+"_hd"+".jpg";			//trace("CARGAR IMAGEN: "+t_imagen);			CargaEscaner(t_imagen);			salida_txt.text="Cargando imagen...";					}				var last_foto_url:String;				function CargaEscaner(liga_fotos) {			last_foto_url=String(liga_fotos);			var mLoader:Loader=new Loader();			var mRequest:URLRequest=new URLRequest(liga_fotos);			mLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,onCompleteHandler);			mLoader.load(mRequest);			//circulo_mc.scaleX=0.5;			//circulo_mc.scaleY=0.5;			//nombre_mc.scaleX=0.5;			//nombre_mc.scaleY=0.5;			//nombre_mc.x += 10;			//nombre_mc.y += 10;			//img_x=circulo_mc.x;			//img_y=circulo_mc.y;		}		function onCompleteHandler(loadEvent:Event) {			var image:Bitmap = Bitmap(loadEvent.currentTarget.content);          	image.smoothing=true;			removeChildrenOf(fondo_mc);			fondo_mc.addChildAt(image,0);						salida_txt.text="Carga completa.";						carga_completa=true;						//var $newwidth=200;			//var $newheight = ($newwidth*circulo_mc.img_mc.height)/circulo_mc.img_mc.width;						//circulo_mc.img_mc.width = $newwidth;			//circulo_mc.img_mc.height = $newheight;						//circulo_mc.scaleX=0.5;			//circulo_mc.scaleY=0.5;		}					}	}